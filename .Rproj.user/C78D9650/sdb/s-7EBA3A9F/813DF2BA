{
    "collab_server" : "",
    "contents" : "---\n  title: \"大數據分析方法\"\nauthor: \"曾意儒 Yi-Ju Tseng, 長庚大學資管系\"\ndate: \"May 2, 2016\"\noutput: ioslides_presentation\nsubtitle: \"探索性分析 Exploratory Analysis: 圖形分析-3\"\nhighlighter: highlight.js\n---\n  \n  \n  ## Homework 5\n  - 分組名單\n- 期末報告題目\n- 預計分析資料\n- 資料來源\n- 資料格式\n- 預計分析議題\n- 假設\n- 預計得到的結果\n- 分析結果可以解決什麼問題\n- 5/2 (一) 11:59pm\n- http://goo.gl/forms/8UgvNQlHVp\n\n## 靈感！？\n- [R Blogger](http://www.r-bloggers.com/)\n- [Data Man的資料視覺化筆記](https://www.facebook.com/imDataMan/)\n- [Data USA](http://datausa.io/)\n- [Randy Olson Twitter](https://twitter.com/randal_olson)\n- [Washington Post Information Graphics](http://postgraphics.tumblr.com/)\n- [Washington Post | FlowingData](https://flowingdata.com/tag/washington-post/)\n- [New York Times | FlowingData](https://flowingdata.com/tag/new-york-times/)\n\n## 其他題目？\n- Facebook 粉絲專頁分析，政治人物最愛說的話，說什麼詞彙like數會最多\n- NBA 各隊分析，勝利參數，球員相似度\n- You bike與天氣，空汙，Youbike適合分數\n- 離婚結婚生小孩死亡地圖\n- 鉛管，實價登錄，淹水\n- 氣溫，google搜尋\n- 水質，降雨量\n- 癌症死亡率跟工廠分佈\n- 台詞 電影 分類 rating\n\n## 期末報告規定\n- 2-4人一組 —> 44/3=15組\n- 兩次上課，300分鐘 —> 一組可用20分鐘\n- 報告15分鐘，問問題5分鐘 —> 講重點，嚴格計時\n- 整組交一份書面報告\n- 組員與工作分配（會影響成績）、資料分析報告、資料討論/遇到的困難\n\n## 期末報告時間\n- 5/30: 1組\n- 6/6: 4組\n- 6/13: 5組\n- 6/20: 5組\n\n## 上課用程式碼\n[Rmd下載](https://github.com/yijutseng/BigDataCGUIM/blob/master/BigData20160502.Rmd)\n\n按Raw，右鍵另存新檔\n\n投影片下載：\n\n[Html下載](https://raw.githubusercontent.com/yijutseng/BigDataCGUIM/master/BigData20160502.html)\n\n按右鍵，另存新檔\n\n# Plotting System--Base\n\n## 探索圖範例：又是大家熟悉的NBA...\n\n```{r message=FALSE,warning=FALSE}\n#讀入SportsAnalytics package\nif (!require('SportsAnalytics')){\n  install.packages(\"SportsAnalytics\")\n  library(SportsAnalytics)\n}\n#擷取2014-2015年球季球員資料\nNBA1415<-fetch_NBAPlayerStatistics(\"14-15\")\n```\n\n\n## Simple Summaries of Data - 1\n\nOne dimension\n\n- Five-number summary `summary(NBA1415$TotalPoints)`\n- Boxplots 箱型圖 `boxplot(NBA1415$TotalPoints)`\n- Histograms 直方圖 `hist(NBA1415$TotalPoints)`\n- Density plot 密度圖 `density(NBA1415$TotalPoints)`\n- Barplot 條狀圖 `barplot(table(NBA1415$Team))`\n\n\n## Simple Summaries of Data - 2\n\nTwo dimensions\n\n- Multiple/overlayed 1-D plots (Lattice/ggplot2)\n- Scatterplots 散佈圖 `plot(x,y)`\n- Smooth scatterplots\n\n$> 2$ dimensions\n\n- Overlayed/multiple 2-D plots; coplots\n- Use color, size, shape to add dimensions\n- Spinning plots `類3D圖`\n- Actual 3-D plots (not that useful)\n\n\n\n\n## Multiple Boxplots\n\n```{r,fig.height=8,fig.height=3.5}\n#預計要做圖的'值'（TotalPoints） ~ 分組依據（Team）\nboxplot(TotalPoints ~ Team, data = NBA1415, col = \"red\")\n```\n\n\n\n## Multiple Histograms\n\n```{r,fig.height=8,fig.height=3.5}\n#mfrow設定一張圖裡有多少子圖，mar設定邊界大小\npar(mfrow = c(2, 1), mar = c(4, 4, 2, 1)) #一張圖裡面有2x1個子圖\nhist(subset(NBA1415, Team == \"SAN\")$TotalPoints, col = \"green\")\nhist(subset(NBA1415, Team == \"GSW\")$TotalPoints, col = \"green\")\n```\n\n\n\n## Scatterplot\n\n```{r,fig.height=3}\npar(mfrow = c(1, 1)) #一張圖裡面只有一個子圖\n#畫x為TotalMinutesPlayed, y為TotalPoints的散佈圖\nplot(NBA1415$TotalMinutesPlayed, NBA1415$TotalPoints)\n#畫一條橫線h = 500，寬度lwd = 2，樣式lty = 2（虛線）\nabline(h = 500, lwd = 2, lty = 2)\n```\n\n\n\n## Scatterplot - Using Color\n用顏色在二維散佈圖中加上第三維的資訊\n```{r,fig.height=3}\n#col=NBA1415$Team 用隊伍名稱著色，意指不同隊伍的球員不同色\nplot(NBA1415$TotalMinutesPlayed, NBA1415$TotalPoints,col=NBA1415$Team)\nabline(h = 500, lwd = 2, lty = 2)\n```\n\n\n\n## Multiple Scatterplots\n\n```{r,fig.height=3.5}\n#mfrow設定一張圖裡有多少子圖，mar設定邊界大小\npar(mfrow = c(1, 2), mar = c(5, 4, 2, 1)) #一張圖裡面有1x2個子圖\nwith(subset(NBA1415, Team == \"SAN\"), #取得NBA1415中，隊伍是SAN的Row\n     plot(TotalMinutesPlayed, TotalPoints, main = \"SAN\"))#main=標題\nwith(subset(NBA1415, Team == \"GSW\"), \n     plot(TotalMinutesPlayed, TotalPoints, main = \"GSW\"))\n```\n\n\n\n## Summary\n\n- Exploratory plots are \"quick and dirty\"\n\n- Let you summarize the data (usually graphically) and highlight any broad features\n\n- Explore basic questions and hypotheses (and perhaps rule them out)\n\n- Suggest modeling strategies for the \"next step\"\n\n\n## Further resources\n\n- [R Graph Gallery](http://gallery.r-enthusiasts.com/)\n- [R Graph Gallery](http://www.r-graph-gallery.com/all-graphs/)\n- [R Bloggers](http://www.r-bloggers.com/)\n- [Interactive visualizations with R](http://ouzor.github.io/blog/2014/11/21/interactive-visualizations.html)\n\n\n# Plotting System -Lattice\n\n## The Lattice Plotting System\n包括以下Packaes:\n  \n  - `lattice`: 包括畫圖相關的函數functions: `xyplot`, `bwplot`, `levelplot`\n\n- `grid`: `lattice` package 的基礎\n\n- 一個函數畫完圖，不能再加標記和文字等資料（和base畫圖法不同）\n\n\n\n## Lattice Functions\n\n- `xyplot`: 畫散佈圖 scatterplots \n- `bwplot`: 畫盒鬚圖box-and-whiskers plots (“boxplots”)\n- `histogram`: 直方圖 histograms\n- `stripplot`: 盒鬚圖＋點\n- `dotplot`:  dots on \"violin strings\"\n- `splom`: 散佈圖的矩陣\n- `levelplot`, `contourplot`: for plotting \"image\" data\n\n\n\n## Lattice Functions\n\n\n```r\nxyplot(y ~ x | f ` g, data)\n```\n- Lattice functions 通常第一個參數是 formula \n- `y~x`: y-axis~x-axis `formula notation` \n- `f,g` are `conditioning variables` \n— optional\n- ```:  an interaction between two variables\n\n- 第二個參數是資料`data`\n- 其他參數都是預設值\n\n\n## Simple Lattice Plot\n\n```{r,fig.height=3.5}\nlibrary(lattice)\nlibrary(datasets)\n## Simple scatterplot\nxyplot(Ozone ~ Wind, data = airquality) # y軸~x軸\n```\n\n\n\n## Simple Lattice Plot\n\n```{r,fig.height=8,fig.height=3}\nlibrary(datasets)\nlibrary(lattice)\n## Convert 'Month' to a factor variable\nairquality <- transform(airquality, Month = factor(Month)) \nxyplot(Ozone ~ Wind | Month, #y軸~x軸 | 分組依據\n       data = airquality, layout = c(5, 1)) # 5 rows, 1 column\n```\n\n```{r,fig.height=8,fig.height=3}\nlibrary(datasets)\nlibrary(lattice)\n## Convert 'Month' to a factor variable\nairquality <- transform(airquality, Month = factor(Month)) \nxyplot(Wind ~ Ozone | Month, #y軸~x軸 | 分組依據\n       data = airquality, layout = c(1, 5)) # 5 rows, 1 column\n```\n\n## Lattice Behavior-1\n\n```{r,fig.height=3.5,fig.height=5}\np <- xyplot(Ozone ~ Wind, data = airquality)  ## Nothing happens!\nprint(p)  ## Plot appears\n```\n\n## Lattice Behavior-2\n```{r,eval=FALSE}\nxyplot(Ozone ~ Wind, data = airquality)  ## Auto-printing\n```\n\n\n## Summary\n\n- Lattice plots 用一個單一函數畫圖 (e.g. `xyplot`)\n- 空白和邊緣都有預設值\n- 想看一種圖在不同情況下的差異的時候，很適合\n\n\n# Plotting System -ggplot2\n\n\n## Plotting Systems in R: Base -1\n\n- “Artist’s palette” model\n- Start with blank canvas and build up from there\n- Start with `plot` function (or similar)\n  - Use annotation functions to add/modify (`text`, `lines`, `points`, `axis`)\n\n\n## Plotting Systems in R: Base -2\n\n- Convenient, mirrors how we think of building plots and analyzing data\n- Can’t go back once plot has started (i.e. to adjust margins); need to plan in advance\n- Difficult to “translate” to others once a new plot has been created (no graphical “language”)\n- Plot is just a series of R commands\n\n\n\n## Plotting Systems in R: Lattice\n\n- Plots are created with a single function call (`xyplot`, `bwplot`, etc.)\n- Most useful for conditioning types of plots: Looking at how $y$ changes with $x$ across levels of $z$\n  - Things like margins/spacing set automatically because entire plot is specified at once\n- Good for putting many many plots on a screen\n\n## Plotting Systems in R: Lattice-2\n\n- Sometimes awkward to specify an entire plot in a single function call\n- Annotation in plot is not intuitive\n- Use of panel functions and subscripts difficult to wield and requires intense preparation\n- Cannot “add” to the plot once it’s created\n\n## Plotting Systems in R: ggplot2\n\n- Split the difference between `base` and `lattice`\n- Automatically deals with spacings, text, titles but also allows you to annotate by “adding” `+`\n- Superficial similarity to lattice but generally easier/more intuitive to use\n- Default mode makes many choices for you (but you _can_ customize!)\n\n## What is ggplot2?\n\n- An implementation of `The Grammar of Graphics` by Leland Wilkinson\n- Written by `Hadley Wickham` (while he was a graduate student at Iowa State)\n- A “third” graphics system for R (along with `base` and `lattice`)\n- [Web site](http://ggplot2.org)\n\n\n## What is ggplot2?\n\n- `Grammar of graphics` represents an abstraction of graphics ideas/objects\n- Think “verb”, “noun”, “adjective” for graphics\n- Allows for a “theory” of graphics on which to build new graphics and graphics objects\n\n## Grammer of Graphics\n\n### “In brief, the grammar tells us that a statistical graphic is a `mapping` from data to `aesthetic` attributes (colour, shape, size) of `geometric` objects (points, lines, bars). The plot may also contain statistical transformations of the data and is drawn on a specific coordinate system”\n\n- from `ggplot2` book\n\n## Grammer of Graphics--翻譯一下\n基本元素：\n\n- Aesthetic attributes：包括顏色、形狀、點的大小與線的粗細等\n- Geometric objects：包括點、線、盒狀圖、直條圖等\n\n其他元素包括：\n\n- Facets：提供在同一張圖內做多個子圖的方法，只要使用Faceting功能設定子圖分類的依據參數即可。\n- Stats：將資料做統計轉換\n- Scales：修改點線的顏色、形狀、xy軸的範圍等\n\n## The Basics: `qplot()`\n\n- Works much like the `plot` function in base graphics system\n- Looks for data in a data frame, similar to lattice\n- Plots are made up of `aesthetics` (size, shape, color) and `geoms` (points, lines)\n\n\n## The Basics: `qplot()`\n\n- Factors are important for indicating subsets of the data; they should be `labeled`\n- The `qplot()` hides what goes on underneath, which is okay for most operations\n- `ggplot()` is the core function and very flexible for doing things `qplot()` cannot do\n\n\n## ggplot2 “Hello, world!”\n\n```{r, fig.height=4, warning=F,message=F}\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2) #記得將ggplot2 package讀入，如果沒安奘記得先安裝\n#qplot(x軸,y軸,data=使用資料)--->畫散佈圖\nqplot(FieldGoalsAttempted, TotalPoints, data = NBA1415)\n```\n\n\n\n## Modifying aesthetics\n\n```{r, fig.height=4}\n#color=Position, 用守備位置Position著色\nqplot(FieldGoalsAttempted, TotalPoints, data = NBA1415,color=Position)\n```\n\n\n\n\n## Adding a geom\n\n```{r, fig.height=4}\n#geom = c(\"point\", \"smooth\") 在圖上加點與漸進線\nqplot(FieldGoalsAttempted, TotalPoints, data = NBA1415,\n      geom = c(\"point\", \"smooth\"))\n```\n\n\n\n## Histograms\n\n```{r, fig.height=3.5}\n#畫TotalPoints的直方圖/ fill = Position 並用守備位置Position著色\nqplot(TotalPoints, data = NBA1415, fill = Position)\n```\n\n\n\n## Facets\n```{r, fig.height=3.5}\n#qplot(x軸,y軸,data=使用資料)--->畫散佈圖\n#facets = . ~ Position 用守備位置Position分群畫圖(橫向)\nqplot(FieldGoalsAttempted, TotalPoints, data = NBA1415,\n      facets = . ~ Position)\n```\n\n## Facets\n```{r, fig.height=4}\n#facets = . ~ Position 用守備位置Position分群畫圖(直向)\nqplot(FieldGoalsAttempted, TotalPoints, data = NBA1415,\n      facets = Position ~ .)\nqplot(hwy, data = mpg, facets = drv ~ ., binwidth = 2)\n```\n\n## Facets\n```{r, fig.height=3.5}\n#facets = . ~ Position 用守備位置Position分群畫圖(直向)\n#binwidth = 100 每100分一組\nqplot(TotalPoints, data = NBA1415,\n      facets = Position ~ ., binwidth = 100)\n```\n\n## Summary of qplot()\n\n- The `qplot()` function is the analog to `plot()` but with many built-in features\n- Syntax somewhere in between `base/lattice`\n- Produces very nice graphics, essentially publication ready (if you like the design)\n- Difficult to go against the grain/customize (don’t bother; use full ggplot2 power in that case)\n\n\n\n## Resources\n\n- The `ggplot2` book by Hadley Wickham\n- The `R Graphics Cookbook` by Winston Chang (examples in base plots and in ggplot2)\n- ggplot2 web site (http://ggplot2.org)\n- ggplot2 doc (http://docs.ggplot2.org/current/)\n\n\n## What is ggplot2?\n\n- An implementation of the `Grammar of Graphics` by Leland Wilkinson\n- Grammar of graphics represents and abstraction of graphics ideas/objects\n- Think “verb”, “noun”, “adjective” for graphics\n- Allows for a “theory” of graphics on which to build new graphics and graphics objects\n\n\n\n## Basic Components of a ggplot2 Plot\n- A `data frame`\n- `aesthetic mappings`: how data are mapped to color, size \n- `geoms`: geometric objects like points, lines, shapes. \n- `facets`: for conditional plots. \n- `stats`: statistical transformations like binning, quantiles, smoothing. \n- `scales`: what scale an aesthetic map uses (example: male = red, female = blue). \n- `coordinate system` \n\n\n\n## Building Plots with ggplot2\n- When building plots in ggplot2 (rather than using qplot) the “artist’s palette” model may be the closest analogy\n- Plots are built up in layers\n- Plot the data\n- Overlay a summary\n- Metadata and annotation\n\n\n\n## Annotation\n- Labels: `xlab()`, `ylab()`, `labs()`, `ggtitle()`\n- Each of the “geom” functions has options to modify \n- For things that only make sense globally, use `theme()` \n- Example: `theme(legend.position = \"none\")` \n- Two standard appearance themes are included\n- `theme_gray()`: The default theme (gray background)\n- `theme_bw()`: More stark/plain \n\n## Other themes \n- `ggthemes` packages [Website](https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html)\n- `xkcd` packages [Website](http://xkcd.r-forge.r-project.org/)\n\n\n## 點圖 in ggplot2 geom_point()\n記得讀入`ggplot2` packages\n```{r, fig.height=4.5, fig.height=3}\n#aes: Aesthetic attributes, 顏色、形狀、點的大小與線的粗細\n#geom_*: Geometric objects, 點、線、盒狀圖、直條圖\nggplot(NBA1415, aes(x = Position, y = TotalPoints)) +geom_point()\n```\n\n## Box plot in ggplot2 geom_boxplot()\n記得讀入`ggplot2` packages\n```{r, fig.height=4.5, fig.height=3}\n#aes: Aesthetic attributes, 顏色、形狀、點的大小與線的粗細\n#geom_*: Geometric objects, 點、線、盒狀圖、直條圖\nggplot(NBA1415, aes(x = Position, y = TotalPoints)) +geom_boxplot()\n```\n\n## Faceting in ggplot2 facet_grid()\n```{r, fig.height=4.5, fig.height=3}\n#facet_grid: 加入子圖，Position~.：直向加入，.~Position：橫向加入\nggplot(NBA1415, aes(x = FieldGoalsAttempted, y = TotalPoints)) +\n  geom_point()+facet_grid(Position~.)\n```\n\n## 趨勢線 in ggplot2 geom_smooth()\n```{r, fig.height=4.5, fig.height=3}\n#geom_smooth: 加入趨勢線，method='lm'：linear regression\nggplot(NBA1415, aes(x = FieldGoalsAttempted, y = TotalPoints)) +\n  geom_point()+facet_grid(Position~.)+geom_smooth(method='lm')\n```\n\n## Color group in ggplot2 color=？\n```{r, fig.height=4.5, fig.height=3}\n#color=Position:用Position當作著色依據\nggplot(NBA1415, aes(x = FieldGoalsAttempted, y = TotalPoints,color=Position)) +\n  geom_point()+geom_smooth(method='lm')\n```\n\n\n\n\n## A Note about Axis Limits\n\n```{r, fig.height=4.5, fig.height=3}\ntestdat <- data.frame(x = 1:100, y = rnorm(100))\ntestdat[50,2] <- 100  ## Outlier!\nplot(testdat$x, testdat$y, type = \"l\", ylim = c(-3,3))\n```\n\n## A Note about Axis Limits\n\n```{r, fig.height=4.5, fig.height=3}\ng <- ggplot(testdat, aes(x = x, y = y))\ng + geom_line()\n```\n\n\n\n## Axis Limits\n\n```{r, fig.height=4.5}\ng + geom_line() + ylim(-3, 3)\n```\n\n## Axis Limits\n\n```{r, fig.height=4.5}\ng + geom_line() + coord_cartesian(ylim = c(-3, 3))\n```\n\n\n## ggplot2參考資料\n- [ggplot cheat sheet](https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)\n- [ggplot官網文件](http://docs.ggplot2.org/current/)\n- [r blooger教學範例](http://www.r-bloggers.com/basic-introduction-to-ggplot2/)\n\n# ggplot2與地圖的結合\n\n## Choropleth map\n- [面量圖](https://en.wikipedia.org/wiki/Choropleth_map) \n- 把統計資料用顏色畫在對應的地圖上\n- `choroplethr` package\n- 基於`ggplot2` package所做的專門畫`面量圖`的工具\n```{r, warning=F,message=F}\nif (!require('choroplethr')){\n  install.packages(\"choroplethr\")\n  library(choroplethr)\n}\n```\n\n## 美國各州人口分布\n用到`choroplethr` package, 記得先讀入\n```{r}\ndata(df_pop_state) #記載各州人口數的資料\nstate_choropleth(df_pop_state) #把各州人口畫在地圖上\n```\n\n## 美國各州人口分布-2\n用到`choroplethr` package, 記得先讀入\n```{r, warning=F,message=F, fig.height=3.5}\ndata(continental_us_states)\nstate_choropleth(df_pop_state,reference_map = TRUE,\n                 zoom= continental_us_states) #把各州人口畫在地圖上\n```\n\n## 世界人口分布\n用`choroplethr` package畫地圖，資料來自`WDI` package\n```{r, warning=F,message=F, fig.height=3}\nif (!require('WDI')){\n  install.packages(\"WDI\")\n  library(WDI)\n}\nchoroplethr_wdi(code=\"SP.POP.TOTL\", year=2014, \n                title=\"2016 Population\", num_colors=1)\n```\n\n## 世界平均壽命分布\n- 用`choroplethr` package畫地圖，資料來自`WDI` package\n- `WDI`: [World Development Indicators](http://beta.data.worldbank.org/)有許多開放資料可參考\n```{r warning=F,message=F, fig.height=4}\nchoroplethr_wdi(code=\"SP.DYN.LE00.IN\", year=2014, \n                title=\"2014 Life Expectancy\")\n```\n\n\n## 亞洲太平洋人口分布\n- 用`choroplethr` package畫地圖，資料來自`WDI` package\n- `WDI`: [World Development Indicators](http://beta.data.worldbank.org/)\n- zoom，只畫這些國家，名字要和country.regions資料完全吻合\n```{r, warning=F,message=F, fig.height=2.5}\nchoroplethr_wdi(code=\"SP.POP.TOTL\", year=2014, \n                title=\"2014 Life Expectancy\",\n                zoom=c('taiwan','japan','south korea','philippines'))\n```\n\n## Taiwan?\n- 還沒有好用的package可用\n- 只好自己從頭來了\n- 下載台灣的地圖資料 [DIVA-GIS](http://www.diva-gis.org/gdata)\n- 將下載的`TWN_adm`解壓縮，放到專案資料夾內\n- in `shapefile` [Wiki](https://zh.wikipedia.org/zh-tw/Shapefile)\n- 空間資料開放格式\n- [參考資料](http://www.r-bloggers.com/mapping-with-ggplot-create-a-nice-choropleth-map-in-r/)\n\n## 將shapefile讀入R\n使用`maptools` package 的`readShapeSpatial` function\n```{r, warning=F,message=F, fig.height=3}\nif (!require('rgdal')){\n  install.packages(\"rgdal\");library(rgdal)\n}\nif (!require('gpclib')){\n  install.packages(\"gpclib\");library(gpclib)\n}\nif (!require('rgeos')){\n  install.packages(\"rgeos\");library(rgeos)\n}\nif (!require('maptools')){\n  install.packages(\"maptools\");library(maptools)\n}\ntw_shp <- readShapeSpatial(\"TWN_adm/TWN_adm2.shp\")\nnames(tw_shp) #看tw_shp中各個資料的名字\n```\n\n## 處理shapefile-1\n- 需要`rgdal`, `rgeos`,`gpclib`\n- fortify: 將shapefile物件轉為data.frame\n- [參考資料](http://www.r-bloggers.com/mapping-with-ggplot-create-a-nice-choropleth-map-in-r/)\n```{r, warning=F,message=F, fig.height=3}\nprint(tw_shp$NAME_2)\ntw_shp.df <- fortify(tw_shp, region = \"ID_2\")\n```\n\n## 處理shapefile-2\n- [參考資料](http://www.r-bloggers.com/mapping-with-ggplot-create-a-nice-choropleth-map-in-r/)\n```{r, warning=F,message=F, fig.height=3}\nhead(tw_shp.df)\n```\n\n## 做一個假資料來畫\n```{r, warning=F,message=F, fig.height=3}\n#做一個假資料來畫\nmydata<-data.frame(NAME_2=tw_shp$NAME_2, id=tw_shp$ID_2,\n                   prevalence=1:length(tw_shp$NAME_2))\nhead(mydata)\nfinal.plot<-merge(tw_shp.df,mydata,by=\"id\",all.x=T)\nhead(final.plot)\n```\n\n## 畫台灣地圖-1\n```{r, warning=F,message=F, fig.height=3}\nlibrary(RColorBrewer) #配色用brewer.pal( 9 , \"Reds\" )\ntwmap<-ggplot() +\n  geom_polygon(data = final.plot, \n               aes(x = long, y = lat, group = group, \n                   fill = prevalence), \n               color = \"black\", size = 0.25) + \n  coord_map()+\n  scale_fill_gradientn( colours = brewer.pal(9,\"Reds\"))+\n  theme_void()+\n  labs(title=\"Prevalence of X in Taiwan\")\n```\n\n\n## 畫台灣地圖-2\n```{r, warning=F,message=F, fig.height=5}\ntwmap\n```\n\n\n## ggmap，把google map載入\n```{r, warning=F,message=F, fig.height=3}\nlibrary(ggmap)\nif (!require('ggmap')){\n  install.packages(\"ggmap\")\n  library(ggmap)\n}\ntwmap <- get_map(location = 'Taiwan', zoom = 7,language = \"zh-TW\")\n#location:可以是地名，也可以是經緯度座標\n#zoom:放大比例\n#language:地圖語言\n```\n\n## ggmap，把google map載入\n```{r, warning=F,message=F, fig.height=5}\nggmap(twmap) #基於ggplot2物件，可用相同方式處理\n```\n\n\n## ggmap實際應用範例-1\n台北市水質地圖，資料處理部分\n\nhttp://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&rid=190796c8-7c56-42e0-8068-39242b8ec927\n```{r, warning=F,message=F, fig.height=3}\nlibrary(jsonlite)\nWaterData<-fromJSON(\"http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&rid=190796c8-7c56-42e0-8068-39242b8ec927\")\nWaterDataFrame<-WaterData$result$results\nWaterDataFrame$longitude<-as.numeric(WaterDataFrame$longitude)\nWaterDataFrame$latitude<-as.numeric(WaterDataFrame$latitude)\nWaterDataFrame$qua_cntu<-as.numeric(WaterDataFrame$qua_cntu)\n```\n\n## ggmap實際應用範例-2\n台北市水質地圖，畫圖部分\n```{r, warning=F,message=F, fig.height=3}\nlibrary(ggmap)\nTaipeiMap = get_map(location = c(121.43,24.93,121.62,25.19), \n                    zoom = 11, maptype = 'roadmap')\nTaipeiMapO = ggmap(TaipeiMap)+ \n  geom_point(data=subset(WaterDataFrame,qua_cntu>=0), \n             aes(x=longitude, y=latitude,color=qua_cntu,size=3.5))+ \n  scale_color_continuous(low = \"yellow\",high = \"red\")+ \n  guides(size=FALSE)\n```\n\n## ggmap實際應用範例-3\n台北市水質地圖，畫圖部分\n```{r, warning=F,message=F, fig.height=4}\nTaipeiMapO\n```\n\n",
    "created" : 1462173313032.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3239087794",
    "id" : "813DF2BA",
    "lastKnownWriteTime" : 1462174933,
    "last_content_update" : 1462175630506,
    "path" : "~/R0502/R0502.R",
    "project_path" : "R0502.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}